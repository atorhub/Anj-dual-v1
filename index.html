<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ANJ Dual OCR Parser</title>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-carbon sidebar-hidden">

<div class="app-shell">

  <!-- ================= SIDEBAR ================= -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">ANJ</div>
      <button id="sidebarCloseBtn" class="sidebar-close" aria-label="Close sidebar">‚úï</button>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-item active" data-page="upload">
        <span class="nav-icon">üì§</span>
        <span class="nav-label">Upload</span>
      </div>
      <div class="nav-item" data-page="parsed">
        <span class="nav-icon">üìÑ</span>
        <span class="nav-label">Parsed</span>
      </div>
      <div class="nav-item" data-page="history">
        <span class="nav-icon">üïò</span>
        <span class="nav-label">History</span>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="nav-item" data-page="settings">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span class="nav-label">Settings</span>
      </div>
      <div class="nav-item" data-page="about">
        <span class="nav-icon">‚ÑπÔ∏è</span>
        <span class="nav-label">About</span>
      </div>
      <div class="nav-item" data-page="privacy">
        <span class="nav-icon">üîí</span>
        <span class="nav-label">Privacy</span>
      </div>
    </div>
  </aside>

  <!-- ================= MAIN ================= -->
  <main class="main">

    <!-- TOP BAR -->
    <header class="topbar">
      <button id="sidebarToggle" class="topbar-menu" aria-label="Toggle menu">‚ò∞</button>
      <nav class="topbar-nav">
        <div class="nav-pill active" data-page="upload">Upload</div>
        <div class="nav-pill" data-page="parsed">Parsed</div>
        <div class="nav-pill" data-page="history">History</div>
      </nav>
      <div class="topbar-meta">
        <span class="user-id" id="userIdDisplay">User: ‚Äî</span>
        <span class="status-indicator" id="statusBar">Ready</span>
      </div>
    </header>

    <!-- ================= PAGES ================= -->
    <div class="page-container">

      <!-- UPLOAD PAGE -->
      <section class="page page-upload active">
        
        <!-- Upload Zone -->
        <div class="upload-section">
          <div class="upload-zone" id="uploadZone">
            <input type="file" id="fileInput" class="upload-input" accept="image/*,application/pdf" />
            <div class="upload-prompt">
              <span class="upload-icon">üìÑ</span>
              <p class="upload-text">Upload your invoice to verify it instantly</p>
            </div>
            <div class="upload-actions">
              <button id="dualOCRBtn" class="btn-primary">Dual OCR</button>
              <button id="ocrOnlyBtn" class="btn-secondary">Quick OCR</button>
            </div>
          </div>
        </div>

        <!-- Recent Invoices (shows when empty) -->
        <div class="recent-section" id="recentSection">
          <h3 class="section-title">Recent</h3>
          <div class="recent-grid" id="recentGrid">
            <!-- Populated by JS -->
            <div class="recent-empty">No recent invoices</div>
          </div>
        </div>

        <!-- Results Section (hidden until upload) -->
        <div class="results-section" id="resultsSection" hidden>
          <div class="results-grid">
            <section class="panel panel-raw">
              <h2 class="panel-title">Raw Text</h2>
              <pre id="rawText" class="panel-content">‚Äî</pre>
            </section>
            <section class="panel panel-cleaned">
              <h2 class="panel-title">Cleaned Text</h2>
              <pre id="cleanedText" class="panel-content">‚Äî</pre>
            </section>
          </div>
          <div class="parse-action">
            <button id="parseBtn" class="btn-accent">Parse Invoice</button>
          </div>
        </div>

      </section>

      <!-- PARSED PAGE -->
      <section class="page page-parsed">
        <div class="parsed-layout">
          <section class="panel panel-invoice">
            <h2 class="panel-title">Invoice Details</h2>
            
            <div class="invoice-card">
              <div class="invoice-field">
                <label class="field-label">Merchant</label>
                <input type="text" id="editMerchant" class="field-input" placeholder="‚Äî" />
              </div>
              <div class="invoice-field">
                <label class="field-label">Date</label>
                <input type="text" id="editDate" class="field-input" placeholder="‚Äî" />
              </div>
              <div class="invoice-field">
                <label class="field-label">Total</label>
                <input type="text" id="editTotal" class="field-input" placeholder="‚Äî" />
              </div>
            </div>

            <div class="verification-badge" id="verificationBadge">
              <span class="badge-icon">‚è≥</span>
              <span class="badge-text">Waiting for verification</span>
            </div>

            <div class="invoice-actions">
              <button id="saveBtn" class="btn-primary">üíæ Save to History</button>
            </div>
          </section>

          <section class="panel panel-export">
            <h2 class="panel-title">Export</h2>
            <div class="export-grid">
              <button id="exportJSON" class="btn-export">JSON</button>
              <button id="exportTXT" class="btn-export">TXT</button>
              <button id="exportCSV" class="btn-export">CSV</button>
            </div>
            <pre id="jsonPreview" class="preview-block">// Parsed data will appear here</pre>
          </section>
        </div>
      </section>

      <!-- HISTORY PAGE -->
      <section class="page page-history">
        <section class="panel">
          <h2 class="panel-title">History</h2>
          <div class="history-search">
            <input type="text" id="historySearch" class="search-input" placeholder="Search invoices..." />
          </div>
          <ul class="history-list" id="historyPageList">
            <li class="history-empty">No saved invoices yet</li>
          </ul>
          <button id="clearHistoryBtn" class="btn-danger">Clear All History</button>
        </section>
      </section>

      <!-- SETTINGS PAGE -->
      <section class="page page-settings">
        <div class="settings-layout">
          
          <section class="panel panel-settings">
            <h2 class="panel-title">Appearance</h2>
            <div class="setting-item">
              <label class="setting-label">Theme</label>
              <select id="themeSelect" class="setting-select">
                <!-- JS populates this -->
              </select>
            </div>
            <div class="setting-item">
              <label class="setting-label">Animation Speed</label>
              <div class="setting-options">
                <button class="option-btn active">Normal</button>
                <button class="option-btn">Fast</button>
                <button class="option-btn">Reduced</button>
              </div>
            </div>
          </section>

          <section class="panel panel-settings">
            <h2 class="panel-title">OCR Engine</h2>
            <div class="setting-item">
              <label class="setting-label">Quality vs Speed</label>
              <input type="range" class="setting-slider" min="1" max="3" value="2" />
              <div class="slider-labels">
                <span>Fast</span>
                <span>Balanced</span>
                <span>Precise</span>
              </div>
            </div>
          </section>

          <section class="panel panel-settings">
            <h2 class="panel-title">Export Defaults</h2>
            <div class="setting-item">
              <label class="setting-label">Default Format</label>
              <select class="setting-select">
                <option>JSON</option>
                <option>CSV</option>
                <option>TXT</option>
              </select>
            </div>
            <div class="setting-item">
              <label class="setting-toggle">
                <input type="checkbox" />
                <span>Auto-download after parse</span>
              </label>
            </div>
          </section>

          <section class="panel panel-settings">
            <h2 class="panel-title">Privacy</h2>
            <div class="setting-item">
              <button class="btn-secondary">Clear All History</button>
            </div>
            <div class="setting-item">
              <button class="btn-secondary">Reset User ID</button>
            </div>
            <p class="setting-note">All processing happens locally. No data leaves your device.</p>
          </section>

        </div>
      </section>

      <!-- ABOUT PAGE -->
      <section class="page page-about">
        <section class="panel panel-about">
          <h2 class="panel-title">ANJ Dual OCR Parser</h2>
          <div class="about-version">Version 2.1.0</div>
          
          <div class="about-description">
            <p>Built for professionals who demand precision. ANJ combines dual-engine OCR technology with deterministic verification algorithms to ensure every invoice is parsed accurately ‚Äî <strong>no guesses, no hidden fees detected.</strong></p>
          </div>

          <div class="about-features">
            <h3>Capabilities</h3>
            <ul>
              <li>Military-grade text extraction</li>
              <li>Real-time invoice verification</li>
              <li>Bank-level privacy (all local, zero cloud)</li>
              <li>50+ currency formats supported</li>
              <li>Deterministic math verification</li>
            </ul>
          </div>

          <div class="about-creator">
            <p>Created by a solo developer obsessed with receipt accuracy.</p>
          </div>

          <div class="about-links">
            <a href="#" class="link-btn">GitHub</a>
            <a href="#" class="link-btn">Report Issue</a>
          </div>
        </section>
      </section>

      <!-- PRIVACY PAGE -->
      <section class="page page-privacy">
        <section class="panel">
          <h2 class="panel-title">Privacy Settings</h2>
          <div class="privacy-content">
            <p>Your data never leaves this device. All OCR processing happens locally in your browser using Tesseract.js and PDF.js.</p>
            
            <div class="privacy-stats">
              <div class="stat-item">
                <span class="stat-label">Storage Used</span>
                <span class="stat-value" id="storageUsed">‚Äî</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Invoices Stored</span>
                <span class="stat-value" id="invoicesStored">‚Äî</span>
              </div>
            </div>

            <div class="privacy-actions">
              <button class="btn-danger">Export All Data</button>
              <button class="btn-secondary">Import Data</button>
            </div>
          </div>
        </section>
      </section>

    </div>
  </main>
</div>

<!-- OCR libs -->
<script src="pdf.min.js"></script>
<script src="tesseract.min.js"></script>

<!-- App logic -->
<script type="module" src="./script.js"></script>

</body>
  </html>
