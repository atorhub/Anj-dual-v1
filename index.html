<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ANJ Dual OCR Parser</title>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-carbon sidebar-hidden">

<div class="app-shell">

  <!-- ================= SIDEBAR ================= -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">ANJ</div>
      <button id="sidebarCloseBtn" class="sidebar-close" aria-label="Close sidebar">‚úï</button>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-item active" data-page="upload">
        <span class="nav-icon">üì§</span>
        <span class="nav-label">Upload</span>
      </div>
      <div class="nav-item" data-page="parsed">
        <span class="nav-icon">üìÑ</span>
        <span class="nav-label">Parsed</span>
      </div>
      <div class="nav-item" data-page="history">
        <span class="nav-icon">üïò</span>
        <span class="nav-label">History</span>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="nav-item" data-page="settings">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span class="nav-label">Settings</span>
      </div>
      <div class="nav-item" data-page="about">
        <span class="nav-icon">‚ÑπÔ∏è</span>
        <span class="nav-label">About</span>
      </div>
      <div class="nav-item" data-page="privacy">
        <span class="nav-icon">üîí</span>
        <span class="nav-label">Privacy</span>
      </div>
    </div>
  </aside>

  <!-- ================= MAIN ================= -->
  <main class="main">

    <!-- TOP BAR -->
    <header class="topbar">
      <button id="sidebarToggle" class="topbar-menu" aria-label="Toggle menu">‚ò∞</button>
      <nav class="topbar-nav">
        <div class="nav-pill active" data-page="upload">Upload</div>
        <div class="nav-pill" data-page="parsed">Parsed</div>
        <div class="nav-pill" data-page="history">History</div>
      </nav>
      <div class="topbar-meta">
        <span class="user-id" id="userIdDisplay">User: ‚Äî</span>
        <span class="status-indicator" id="statusBar">Ready</span>
      </div>
    </header>

    <!-- ================= PAGES ================= -->
    <div class="page-container">

      <!-- UPLOAD PAGE -->
      <section class="page page-upload active">
        
        <!-- Upload Card -->
        <div class="upload-section">
          <div class="upload-card" id="uploadCard">
            <input type="file" id="fileInput" class="upload-input" accept="image/*,application/pdf" />
            <div class="upload-content">
              <span class="upload-icon">üìÑ</span>
              <p class="upload-text">Upload your invoice to verify it instantly</p>
            </div>
          </div>
          
          <!-- Filename Pill -->
          <div class="filename-pill" id="filenamePill" hidden>
            <span>üìé</span>
            <span id="filenameText"></span>
          </div>
          
          <!-- OCR Buttons (hidden initially) -->
          <div class="ocr-actions" id="ocrActions" hidden>
            <div class="ocr-group">
              <button id="dualOCRBtn" class="btn-ocr">Dual OCR</button>
              <button id="ocrOnlyBtn" class="btn-ocr">Quick OCR</button>
            </div>
          </div>
        </div>

        <!-- Recent -->
        <div class="recent-section" id="recentSection">
          <p class="section-label">Recent</p>
          <div class="recent-grid" id="recentGrid">
            <div class="recent-empty">No recent invoices</div>
          </div>
        </div>

        <!-- Results (hidden initially) -->
        <div class="results-section" id="resultsSection" hidden>
          <div class="parse-bar" id="parseBar" hidden>
            <button id="parseBtn" class="btn-parse">Parse Invoice</button>
          </div>
          
          <div class="results-grid">
            <div class="result-panel">
              <div class="result-header">
                <p class="result-title">Raw Text</p>
              </div>
              <div class="result-content">
                <pre id="rawText">‚Äî</pre>
              </div>
            </div>
            <div class="result-panel">
              <div class="result-header">
                <p class="result-title">Cleaned Text</p>
              </div>
              <div class="result-content">
                <pre id="cleanedText">‚Äî</pre>
              </div>
            </div>
          </div>
        </div>

      </section>

      <!-- PARSED PAGE -->
      <section class="page page-parsed">
        <div class="parsed-layout">
          
          <!-- Verification Badge -->
          <div class="verification-badge" id="verificationBadge">
            <span class="badge-icon">‚è≥</span>
            <div class="badge-content">
              <p class="badge-title">Waiting for verification</p>
              <p class="badge-subtitle">Upload and parse an invoice first</p>
            </div>
          </div>

          <!-- Invoice Form -->
          <div class="invoice-form">
            <div class="form-field">
              <label class="field-label">Merchant</label>
              <input type="text" id="editMerchant" class="field-input" placeholder="‚Äî" />
            </div>
            <div class="form-field">
              <label class="field-label">Date</label>
              <input type="text" id="editDate" class="field-input" placeholder="‚Äî" />
            </div>
            <div class="form-field">
              <label class="field-label">Total</label>
              <input type="text" id="editTotal" class="field-input" placeholder="‚Äî" />
            </div>
          </div>

          <!-- Save -->
          <div style="text-align: center; margin-bottom: var(--space-xl);">
            <button id="saveBtn" class="btn-parse">Save to History</button>
          </div>

          <!-- Export -->
          <div class="export-section">
            <p class="export-title">Export</p>
            <div class="export-grid">
              <button id="exportJSON" class="btn-export">JSON</button>
              <button id="exportTXT" class="btn-export">TXT</button>
              <button id="exportCSV" class="btn-export">CSV</button>
            </div>
            <pre class="export-preview" id="jsonPreview">// Parsed data will appear here</pre>
          </div>

        </div>
      </section>

      <!-- HISTORY PAGE -->
      <section class="page page-history">
        <div class="history-layout">
          <p class="section-label">History</p>
          <div class="history-search">
            <input type="text" id="historySearch" class="search-input" placeholder="Search invoices..." />
          </div>
          <ul class="history-list" id="historyPageList">
            <li class="history-empty">No saved invoices yet</li>
          </ul>
          <button id="clearHistoryBtn" class="btn-ocr" style="margin-top: var(--space-xl); width: 100%;">Clear All History</button>
        </div>
      </section>

      <!-- SETTINGS PAGE -->
      <section class="page page-settings">
        <div class="settings-layout">
          
          <div class="settings-card">
            <p class="settings-title">Appearance</p>
            <div class="setting-row">
              <label class="setting-label">Theme</label>
              <select id="themeSelect" class="setting-control">
                <!-- JS populates this -->
              </select>
            </div>
            <div class="setting-row">
              <label class="setting-label">Animation</label>
              <div class="setting-options">
                <button class="option-btn active">Normal</button>
                <button class="option-btn">Fast</button>
                <button class="option-btn">Reduced</button>
              </div>
            </div>
          </div>

          <div class="settings-card">
            <p class="settings-title">OCR Engine</p>
            <div class="setting-row">
              <label class="setting-label">Quality vs Speed</label>
              <input type="range" class="setting-control" min="1" max="3" value="2" />
            </div>
          </div>

          <div class="settings-card">
            <p class="settings-title">Privacy</p>
            <div class="setting-row">
              <button class="btn-ocr" style="width: 100%;">Clear All History</button>
            </div>
            <p style="font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--space-lg); line-height: 1.6;">
              All processing happens locally. No data leaves your device.
            </p>
          </div>

        </div>
      </section>

      <!-- ABOUT PAGE -->
      <section class="page page-about">
        <div class="about-layout">
          <div class="about-brand">
            <p class="about-version">ANJ v2.1.0</p>
            <p class="about-tagline">Precision invoice verification<br>for professionals who demand accuracy</p>
          </div>
          
          <p class="about-description">
            ANJ combines dual-engine OCR with deterministic verification. 
            Every invoice is parsed and validated‚Äîno guesses, no hidden fees missed.
          </p>

          <div class="about-features">
            <div class="feature-item">
              <span class="feature-check">‚úì</span>
              <span class="feature-text">Military-grade text extraction</span>
            </div>
            <div class="feature-item">
              <span class="feature-check">‚úì</span>
              <span class="feature-text">Real-time invoice verification</span>
            </div>
            <div class="feature-item">
              <span class="feature-check">‚úì</span>
              <span class="feature-text">Bank-level privacy, zero cloud</span>
            </div>
            <div class="feature-item">
              <span class="feature-check">‚úì</span>
              <span class="feature-text">50+ currency formats supported</span>
            </div>
          </div>

          <p class="about-creator">Created by a solo developer obsessed with accuracy.</p>

          <div class="about-links">
            <a href="#" class="btn-link">GitHub</a>
            <a href="#" class="btn-link">Report Issue</a>
          </div>
        </div>
      </section>

      <!-- PRIVACY PAGE -->
      <section class="page page-privacy">
        <div class="history-layout">
          <p class="section-label">Privacy Settings</p>
          <div class="settings-card">
            <p style="font-size: var(--text-base); color: var(--text-secondary); line-height: 1.7; margin-bottom: var(--space-xl);">
              Your data never leaves this device. All OCR processing happens locally in your browser using Tesseract.js and PDF.js.
            </p>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-lg); margin-bottom: var(--space-xl); padding: var(--space-lg); background: var(--surface); border-radius: var(--radius-md);">
              <div>
                <p style="font-size: var(--text-xs); color: var(--text-tertiary); margin-bottom: var(--space-xs);">Storage Used</p>
                <p style="font-size: var(--text-xl); font-weight: 600; color: var(--text-primary); font-family: monospace;" id="storageUsed">‚Äî</p>
              </div>
              <div>
                <p style="font-size: var(--text-xs); color: var(--text-tertiary); margin-bottom: var(--space-xs);">Invoices Stored</p>
                <p style="font-size: var(--text-xl); font-weight: 600; color: var(--text-primary); font-family: monospace;" id="invoicesStored">‚Äî</p>
              </div>
            </div>

            <div style="display: flex; gap: var(--space-md); flex-wrap: wrap;">
              <button class="btn-ocr" style="flex: 1;">Export All Data</button>
              <button class="btn-ocr" style="flex: 1;">Import Data</button>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>
</div>

<!-- OCR libs -->
<script src="pdf.min.js"></script>
<script src="tesseract.min.js"></script>
<!-- App logic -->
<script type="module" src="./script.js"></script>
</body>
</html>

