@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

:root {
  --font: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --space-xs: 0.25rem; --space-sm: 0.5rem; --space-md: 1rem; --space-lg: 1.5rem; --space-xl: 2.5rem; --space-2xl: 4rem;
  --text-xs: 0.6875rem; --text-sm: 0.8125rem; --text-base: 0.9375rem; --text-lg: 1.125rem; --text-xl: 1.375rem;
  --radius-sm: 6px; --radius-md: 12px; --radius-lg: 16px; --radius-full: 9999px;
  --ease: cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
  --duration-fast: 200ms; --duration-base: 300ms; --duration-slow: 500ms;
  
  /* Default Carbon */
  --bg-primary: #050508;
  --bg-gradient: radial-gradient(ellipse at 50% 0%, #0f0f16 0%, #050508 50%, #020204 100%);
  --accent: #6366f1;
  --accent-glow: rgba(99, 102, 241, 0.4);
  --surface: rgba(255, 255, 255, 0.03);
  --surface-hover: rgba(255, 255, 255, 0.06);
  --text-primary: rgba(255, 255, 255, 0.92);
  --text-secondary: rgba(255, 255, 255, 0.55);
  --text-tertiary: rgba(255, 255, 255, 0.35);
}

/* 5 THEMES */
body.theme-carbon { --accent: #6366f1; --accent-glow: rgba(99, 102, 241, 0.4); }
body.theme-aqua-pro { --accent: #06b6d4; --accent-glow: rgba(6, 182, 212, 0.4); --bg-gradient: radial-gradient(ellipse at 50% 0%, #0a1f26 0%, #050d10 50%, #020608 100%); }
body.theme-midnight-blue { --accent: #3b82f6; --accent-glow: rgba(59, 130, 246, 0.4); --bg-gradient: radial-gradient(ellipse at 50% 0%, #0f1a2e 0%, #050a12 50%, #020408 100%); }
body.theme-ivory { --accent: #57534e; --accent-glow: rgba(87, 83, 78, 0.3); --bg-gradient: linear-gradient(180deg, #fafaf9 0%, #f5f5f4 100%); --surface: rgba(0, 0, 0, 0.03); --text-primary: rgba(0, 0, 0, 0.9); --text-secondary: rgba(0, 0, 0, 0.55); --text-tertiary: rgba(0, 0, 0, 0.35); }
body.theme-abstract { --accent: #a78bfa; --accent-glow: rgba(167, 139, 250, 0.4); --bg-gradient: radial-gradient(ellipse at 50% 0%, #1a0f2e 0%, #0d0518 50%, #05020a 100%); }

* { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; -webkit-font-smoothing: antialiased; }
body { font-family: var(--font); background: var(--bg-gradient); background-attachment: fixed; color: var(--text-primary); line-height: 1.6; min-height: 100vh; overflow-x: hidden; }

.app-shell { display: grid; grid-template-columns: 1fr; min-height: 100vh; }
@media (min-width: 1024px) { body:not(.sidebar-hidden) .app-shell { grid-template-columns: 260px 1fr; } }

/* SIDEBAR - DARKER */
.sidebar { position: fixed; top: 0; left: 0; width: 260px; height: 100vh; background: rgba(5, 5, 8, 0.95); border-right: 1px solid rgba(255, 255, 255, 0.04); display: flex; flex-direction: column; z-index: 100; transform: translateX(-100%); transition: transform var(--duration-base) var(--ease-out); }
body:not(.sidebar-hidden) .sidebar { transform: translateX(0); }
@media (min-width: 1024px) { .sidebar { position: sticky; transform: translateX(0); } body.sidebar-hidden .sidebar { transform: translateX(-100%); } }

.sidebar-header { display: flex; align-items: center; justify-content: space-between; padding: var(--space-lg); border-bottom: 1px solid rgba(255, 255, 255, 0.04); }
.logo { font-size: var(--text-xl); font-weight: 600; letter-spacing: -0.02em; }
.sidebar-close { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; background: var(--surface); border: none; border-radius: var(--radius-sm); color: var(--text-secondary); cursor: pointer; transition: all var(--duration-fast); }
.sidebar-close:hover { background: var(--surface-hover); color: var(--text-primary); }

.sidebar-nav { flex: 1; padding: var(--space-sm); display: flex; flex-direction: column; gap: var(--space-xs); }
.nav-item { display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md) var(--space-lg); border-radius: var(--radius-sm); color: var(--text-secondary); font-size: var(--text-sm); font-weight: 500; cursor: pointer; transition: all var(--duration-fast); position: relative; }
.nav-item::before { content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%) scaleY(0); width: 3px; height: 20px; background: var(--accent); border-radius: var(--radius-full); transition: transform var(--duration-base) var(--ease-out); }
.nav-item:hover { color: var(--text-primary); background: var(--surface); }
.nav-item.active { color: var(--text-primary); background: var(--surface); }
.nav-item.active::before { transform: translateY(-50%) scaleY(1); }
.nav-icon { opacity: 0.7; }
.sidebar-footer { padding: var(--space-sm); border-top: 1px solid rgba(255, 255, 255, 0.04); display: flex; flex-direction: column; gap: var(--space-xs); }

.topbar { position: sticky; top: 0; display: flex; align-items: center; gap: var(--space-lg); padding: var(--space-md) var(--space-lg); background: rgba(5, 5, 8, 0.9); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.04); z-index: 50; height: 64px; }
.topbar-menu { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; background: var(--surface); border: none; border-radius: var(--radius-sm); color: var(--text-secondary); cursor: pointer; transition: all var(--duration-fast); }
.topbar-menu:hover { background: var(--surface-hover); color: var(--text-primary); }
@media (min-width: 1024px) { body:not(.sidebar-hidden) .topbar-menu { display: none; } }

.topbar-nav { display: none; align-items: center; gap: var(--space-xs); }
@media (min-width: 640px) { .topbar-nav { display: flex; } }
.nav-pill { padding: var(--space-sm) var(--space-md); border-radius: var(--radius-sm); font-size: var(--text-sm); font-weight: 500; color: var(--text-secondary); cursor: pointer; transition: all var(--duration-fast); }
.nav-pill:hover { color: var(--text-primary); background: var(--surface); }
.nav-pill.active { color: white; background: var(--accent); }

.topbar-meta { margin-left: auto; display: flex; align-items: center; gap: var(--space-lg); }
.user-id { display: none; font-size: var(--text-xs); color: var(--text-tertiary); font-family: monospace; text-transform: uppercase; }
@media (min-width: 768px) { .user-id { display: block; } }
.status-indicator { display: flex; align-items: center; gap: var(--space-sm); font-size: var(--text-xs); color: var(--text-tertiary); font-weight: 500; }
.status-indicator::before { content: ''; width: 6px; height: 6px; background: #22c55e; border-radius: var(--radius-full); animation: statusPulse 3s ease-in-out infinite; }
@keyframes statusPulse { 0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); } 50% { opacity: 0.6; box-shadow: 0 0 0 6px rgba(34, 197, 94, 0); } }

.page-container { flex: 1; padding: var(--space-xl) var(--space-lg); max-width: 1200px; margin: 0 auto; width: 100%; min-width: 0; }
.page { display: none; animation: fadeIn 0.5s ease-out; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }

.section-label { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: var(--space-md); }

.upload-section { max-width: 560px; margin: 0 auto var(--space-2xl); }
.upload-card { position: relative; background: var(--surface); border-radius: var(--radius-lg); padding: var(--space-2xl) var(--space-xl); text-align: center; cursor: pointer; transition: all var(--duration-base); overflow: hidden; }
.upload-card::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 0%, var(--accent-glow), transparent 70%); opacity: 0; transition: opacity var(--duration-slow); pointer-events: none; }
.upload-card:hover { transform: translateY(-2px); background: var(--surface-hover); }
.upload-card:hover::before { opacity: 1; }
.upload-card.processing { opacity: 0.6; filter: blur(2px); pointer-events: none; }
.upload-card.has-file { background: var(--surface-hover); transform: scale(0.98); }
.upload-input { position: absolute; inset: 0; opacity: 0; cursor: pointer; z-index: 2; }
.upload-content { position: relative; z-index: 1; pointer-events: none; }
.upload-icon { font-size: var(--text-2xl); margin-bottom: var(--space-lg); opacity: 0.5; transition: all var(--duration-base); }
.upload-card:hover .upload-icon { opacity: 0.8; }
.upload-text { font-size: var(--text-lg); font-weight: 500; line-height: 1.5; margin: 0; animation: gentlePulse 4s ease-in-out infinite; }
@keyframes gentlePulse { 0%, 100% { opacity: 0.75; } 50% { opacity: 0.95; } }

.filename-pill { display: inline-flex; align-items: center; gap: var(--space-sm); margin-top: var(--space-lg); padding: var(--space-sm) var(--space-md); background: var(--accent); color: white; border-radius: var(--radius-full); font-size: var(--text-sm); font-weight: 500; opacity: 0; transform: translateY(10px); animation: pillSettle 0.5s ease-out forwards; }
@keyframes pillSettle { to { opacity: 1; transform: translateY(0); } }
.filename-pill.fade-out { opacity: 0; transform: translateY(-10px); transition: all 0.5s; }

.ocr-actions { margin-top: var(--space-xl); display: flex; flex-direction: column; gap: var(--space-md); align-items: center; opacity: 0; transform: translateY(20px); animation: actionsAppear 0.5s ease-out forwards; animation-delay: 200ms; }
.ocr-actions[hidden] { display: none; }
@keyframes actionsAppear { to { opacity: 1; transform: translateY(0); } }

.ocr-primary, .ocr-secondary { width: 100%; max-width: 280px; text-align: center; }
.ocr-primary { position: relative; }
.ocr-primary::after { content: 'Recommended'; position: absolute; top: -8px; right: -8px; background: var(--accent); color: white; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: var(--radius-full); text-transform: uppercase; letter-spacing: 0.05em; }

.btn-primary { width: 100%; padding: var(--space-md) var(--space-xl); background: var(--accent); border: none; border-radius: var(--radius-sm); color: white; font-size: var(--text-base); font-weight: 600; cursor: pointer; transition: all var(--duration-fast); box-shadow: 0 4px 20px var(--accent-glow); }
.btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 30px var(--accent-glow); }
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }

.btn-secondary { width: 100%; padding: var(--space-md) var(--space-xl); background: var(--surface); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: var(--radius-sm); color: var(--text-primary); font-size: var(--text-sm); font-weight: 500; cursor: pointer; transition: all var(--duration-fast); }
.btn-secondary:hover { background: var(--surface-hover); border-color: rgba(255, 255, 255, 0.15); }

.ocr-hint { font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-sm); }

.results-section { margin-top: var(--space-2xl); opacity: 0; transform: translateY(30px); animation: resultsEnter 0.5s ease-out forwards; }
.results-section[hidden] { display: none; }
@keyframes resultsEnter { to { opacity: 1; transform: translateY(0); } }

.parse-bar { text-align: center; margin-bottom: var(--space-xl); opacity: 0; animation: parseAppear 0.5s ease-out forwards; animation-delay: 200ms; }
.parse-bar[hidden] { display: none; }
@keyframes parseAppear { to { opacity: 1; } }

.btn-parse { padding: var(--space-md) var(--space-2xl); background: var(--accent); border: none; border-radius: var(--radius-sm); color: white; font-size: var(--text-base); font-weight: 600; cursor: pointer; transition: all var(--duration-fast); box-shadow: 0 4px 20px var(--accent-glow); position: relative; overflow: hidden; }
.btn-parse:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; }
.btn-parse:not(:disabled)::after { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transform: translateX(-100%); animation: shimmer 2s infinite; }
@keyframes shimmer { 100% { transform: translateX(100%); } }
.btn-parse:not(:disabled):hover { transform: translateY(-2px); box-shadow: 0 8px 40px var(--accent-glow); }

.parse-hint { font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-sm); min-height: 18px; }

.results-grid { display: grid; gap: var(--space-lg); grid-template-columns: 1fr; }
@media (min-width: 1024px) { .results-grid { grid-template-columns: 2fr 1fr; } }

.result-panel { background: var(--surface); border-radius: var(--radius-md); overflow: hidden; min-width: 0; }
.panel-cleaned { border: 1px solid var(--accent); box-shadow: 0 0 20px var(--accent-glow); }
.panel-raw { opacity: 0.7; }
.panel-raw.collapsed .result-content { display: none; }
.panel-raw.collapsed .collapse-icon { transform: rotate(-90deg); }

.result-header { padding: var(--space-md) var(--space-lg); border-bottom: 1px solid rgba(255, 255, 255, 0.03); display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
.panel-cleaned .result-header { cursor: default; }
.result-title { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.1em; display: flex; align-items: center; gap: var(--space-sm); }
.result-badge { background: var(--accent); color: white; font-size: 10px; padding: 2px 8px; border-radius: var(--radius-full); text-transform: none; letter-spacing: 0; }
.collapse-icon { font-size: 10px; transition: transform var(--duration-fast); }

.result-content { padding: var(--space-lg); background: rgba(0, 0, 0, 0.2); min-height: 200px; max-height: 400px; overflow: auto; min-width: 0; }
.result-content pre { font-family: var(--font); font-size: var(--text-sm); color: var(--text-secondary); line-height: 1.7; white-space: pre-wrap; word-break: break-word; overflow-wrap: break-word; max-width: 100%; }

.recent-section { max-width: 800px; margin: 0 auto; }
.recent-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: var(--space-md); }
.recent-empty { grid-column: 1 / -1; padding: var(--space-2xl); text-align: center; color: var(--text-tertiary); font-size: var(--text-base); }
.recent-card { background: var(--surface); border-radius: var(--radius-md); padding: var(--space-lg); cursor: pointer; transition: all var(--duration-base); }
.recent-card:hover { transform: translateY(-3px); background: var(--surface-hover); }
.recent-icon { font-size: var(--text-xl); margin-bottom: var(--space-md); opacity: 0.5; }
.recent-name { font-size: var(--text-sm); font-weight: 500; color: var(--text-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.recent-time { font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-xs); }

.parsed-layout { max-width: 720px; margin: 0 auto; }
.verification-badge { display: flex; align-items: center; gap: var(--space-md); padding: var(--space-lg); background: var(--surface); border-radius: var(--radius-md); margin-bottom: var(--space-xl); transition: all var(--duration-base); }
.verification-badge.verified { border-left: 3px solid #22c55e; }
.verification-badge.warning { border-left: 3px solid #eab308; }
.verification-badge.error { border-left: 3px solid #ef4444; }
.badge-icon { font-size: var(--text-xl); }
.badge-content { flex: 1; }
.badge-title { font-size: var(--text-base); font-weight: 600; color: var(--text-primary); }
.badge-subtitle { font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--space-xs); }

.invoice-form { display: grid; gap: var(--space-xl); margin-bottom: var(--space-xl); }
.form-field { display: flex; flex-direction: column; gap: var(--space-sm); }
.field-label { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.1em; display: flex; align-items: center; gap: var(--space-sm); }
.edit-hint { font-size: 10px; color: var(--text-tertiary); text-transform: none; letter-spacing: 0; font-weight: 400; }
.field-input { background: var(--surface); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: var(--radius-sm); padding: var(--space-md) var(--space-lg); color: var(--text-primary); font-size: var(--text-base); transition: all var(--duration-fast); }
.field-input:focus { outline: none; border-color: var(--accent); background: var(--surface-hover); }

.items-section { margin-bottom: var(--space-xl); }
.items-table { width: 100%; border-collapse: collapse; font-size: var(--text-sm); }
.items-table th { text-align: left; padding: var(--space-md); color: var(--text-tertiary); font-weight: 600; text-transform: uppercase; font-size: var(--text-xs); letter-spacing: 0.05em; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
.items-table td { padding: var(--space-md); color: var(--text-secondary); border-bottom: 1px solid rgba(255, 255, 255, 0.03); }
.items-table tr:hover td { color: var(--text-primary); background: var(--surface-hover); }

.save-section { text-align: center; margin-bottom: var(--space-xl); }
.save-hint { font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--space-md); min-height: 20px; }

.export-section { background: var(--surface); border-radius: var(--radius-md); padding: var(--space-lg); }
.export-title { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-md); }
.export-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-md); margin-bottom: var(--space-lg); }
.btn-export { padding: var(--space-md); background: rgba(0, 0, 0, 0.3); border: none; border-radius: var(--radius-sm); color: var(--text-secondary); font-size: var(--text-sm); font-weight: 500; cursor: pointer; transition: all var(--duration-fast); }
.btn-export:hover { background: var(--surface-hover); color: var(--text-primary); }
.export-preview { background: rgba(0, 0, 0, 0.3); border-radius: var(--radius-sm); padding: var(--space-md); font-family: monospace; font-size: var(--text-xs); color: var(--text-secondary); max-height: 150px; overflow: auto; white-space: pre-wrap; word-break: break-word; }

.history-layout { max-width: 640px; margin: 0 auto; }
.history-search { margin-bottom: var(--space-xl); }
.search-input { width: 100%; background: var(--surface); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: var(--radius-md); padding: var(--space-md) var(--space-lg); color: var(--text-primary); font-size: var(--text-base); }
.search-input:focus { outline: none; border-color: var(--accent); }
.history-list { list-style: none; display: flex; flex-direction: column; gap: var(--space-md); }
.history-item { display: flex; align-items: center; gap: var(--space-md); padding: var(--space-lg); background: var(--surface); border-radius: var(--radius-md); cursor: pointer; transition: all var(--duration-fast); }
.history-item:hover { background: var(--surface-hover); }
.history-icon { font-size: var(--text-lg); opacity: 0.5; }
.history-info { flex: 1; }
.history-name { font-size: var(--text-sm); font-weight: 500; color: var(--text-primary); }
.history-date { font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-xs); }
.history-amount { font-size: var(--text-base); font-weight: 600; color: var(--text-secondary); }

.settings-layout { max-width: 600px; margin: 0 auto; display: grid; gap: var(--space-lg); }
.settings-card { background: var(--surface); border-radius: var(--radius-md); padding: var(--space-xl); }
.settings-title { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-lg); }
.setting-row { margin-bottom: var(--space-lg); }
.setting-row:last-child { margin-bottom: 0; }
.setting-label { font-size: var(--text-sm); font-weight: 500; color: var(--text-secondary); margin-bottom: var(--space-sm); display: block; }
.setting-control { width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: var(--radius-sm); padding: var(--space-md); color: var(--text-primary); font-size: var(--text-base); }
.setting-options { display: flex; gap: var(--space-sm); }
.option-btn { flex: 1; padding: var(--space-sm) var(--space-md); background: rgba(0, 0, 0, 0.3); border: 1px solid transparent; border-radius: var(--radius-sm); color: var(--text-secondary); 
font-size: var(--text-sm); cursor: pointer; transition: all var(--duration-fast); }
.option-btn:hover { background: var(--surface-hover); color: var(--text-primary); }
.option-btn.active { background: var(--accent); color: white; }

.about-layout { max-width: 480px; margin: 0 auto; text-align: center; padding: var(--space-2xl) 0; }
.about-brand { margin-bottom: var(--space-xl); }
.about-version { font-size: var(--text-xs); color: var(--text-tertiary); font-family: monospace; letter-spacing: 0.05em; margin-bottom: var(--space-sm); }
.about-tagline { font-size: var(--text-2xl); font-weight: 600; color: var(--text-primary); line-height: 1.3; }
.about-description { font-size: var(--text-base); color: var(--text-secondary); line-height: 1.7; margin-bottom: var(--space-xl); }
.about-links { display: flex; gap: var(--space-md); justify-content: center; }
.btn-link { padding: var(--space-md) var(--space-xl); background: var(--surface); border-radius: var(--radius-sm); color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm); font-weight: 500; transition: all var(--duration-fast); }
.btn-link:hover { background: var(--surface-hover); color: var(--text-primary); }

[hidden] { display: none !important; }
@media (prefers-reduced-motion: reduce) { * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; } }
:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
